### 项目是NL-STV_test的升级版本
原项目链接：https://github.com/Allforblue/NL-STV_test.git

### 基于LLM的时空数据可视化平台NL-STV
版本号：0.2.1


### 全新架构
前后端分离：
- 后端：FastAPI
- 前端：React + Vite

#### 项目组织架构
暂未更新
```text
NL-STV-V0.2.1
├── backend/
│   ├── api/
│   │   ├── __init__.py
│   │   ├── chat.py
│   │   ├── data.py
│   │   └── session.py
│   └── core/
│       ├── data_sandbox/
│       ├── execution/
│       │   ├── __init__.py
│       │   ├── executor.py
│       │   └── insight_extractor.py
│       ├── generation/
│       │   ├── __init__.py
│       │   ├── code_generator.py
│       │   ├── dashboard_planner.py
│       │   ├── scaffold.py
│       │   ├── templates.py
│       │   └── viz_editor.py
│       ├── ingestion/
│       │   ├── __init__.py
│       │   ├── ingestion.py
│       │   └── loader_factory.py
│       ├── llm/
│       │   ├── __init__.py
│       │   └── AI_client.py
│       ├── profiler/
│       │   ├── __init__.py
│       │   ├── basic_stats.py
│       │   ├── interaction_mapper.py
│       │   ├── relation_mapper.py
│       │   └── semantic_analyzer.py
│       ├── schemas/
│       │   ├── __init__.py
│       │   ├── dashboard.py
│       │   ├── interaction.py
│       │   └── state.py
│       ├── services/
│       │   ├── __init__.py
│       │   ├── session_service.py
│       │   └── workflow.py
│       └── __init__.py
├── data_sandbox/
├── test/
├── __init__.py
├── app.py
├── main.py
└── pytest.ini
```

### 项目任务书

#### 研究内容
本课题旨在针对当前时空数据分析门槛高、可视化交互复杂等痛点，设计并实现一套基于大语言模型驱动（LLM）的时空数据可视化原型平台。研究内容主要涵盖以下五个方面：

1. 系统框架设计与时空数据标准化接入研究。
针对时空数据多维度、异构化的特性，设计一套分层解耦的平台架构。研究如何构建时空数据管理层，实现对多源数据的元数据提取与标准化描述，为大模型提供清晰的数据“语义地图”。同时，初步探索基于LLM的任务规划机制，将复杂的用户需求拆解为可执行的底层数据处理步骤。

2. 基于LLM的时空意图识别与指令映射研究。
重点探讨如何优化大模型对地理空间语言的理解能力。研究如何将用户关于“空间范围”、“时间尺度”及“属性过滤”的自然语言描述，精准解析并映射为规范的数据查询逻辑与可视化配置参数，实现从“人类自然语言”到“机器执行指令”的智能转换。

3. 多维时空看板自动构建与智能分析解释。
研究时空数据在 Web 端的动态渲染策略与多图表联动方案。开发可视化配置自动生成模块，根据大模型对数据的语义理解，自动匹配最适宜的表现形式。在此基础上，利用大模型的文本生成能力，构建可视化结果自动分析模块，针对生成的图表自动提取核心特征并提供文字形式的深度解释，帮助用户快速理解可视化结果背后反映的业务问题。

4. 基于多模态触发的二次交互与语义钻取机制。
研究如何实现“自然语言”与“地图UI操作”协同驱动的深度交互。重点构建多模态交互映射机制，支持用户通过自然语言指令或在系统提供的地图上进行手动框选、点击等交互行为，触发系统进行语义钻取。研究如何维持交互过程中的上下文状态，使系统能够根据用户反馈进一步细化查询粒度（例如：从全市拥堵概览下钻至特定路段的流量来源分析），实现从“初步感知”到“深度溯源”的交互闭环。

5. 原型系统集成与多维度实证评价。
整合上述研究模块，开发一套完整的一站式时空数据智能可视化原型系统。选取城市交通流分析等典型场景进行实证测试。不仅从技术维度评估系统在指令解析准确率、渲染响应速度等方面的性能，还将通过用户可用性测试，验证大模型驱动模式在降低时空分析门槛、提升非专业用户操作效率方面的实际价值。

### 目前计划：
1. 增加交互功能
2. 时间维度分析，折线图，时间相关的聚类标注，最主要，其实想看能不能绘制动态热力图
3. 可以自己调用一些简单数据分析方法，比如聚类、回归等模型进一步分析数据（这个有一篇chat2Viz的论文似乎可以参考）
4. 时间相关的话，其实还想做OD流向分析，但是似乎比较难
5. 结果洞察目前还比较简单，有待进一步提升，进行更详细的分析，这个需要和聚类回归等结果结合最好
6. 目前项目存在的突出问题是性能较低，主要是AI那边响应比较慢
7. **目前突出问题：时空数据对时间突出不明显**

### 目前问题
1. 性能待优化，运行效率是在过于底下，消耗token过快
2. 热力图图例不要用color_score
3. 可以对交互锚点进行缓存
4. 可以对semantic_analyze进行并发
5. 维度统计的小图结果不是很稳定
6. 版本管理还是有问题，有点麻烦

